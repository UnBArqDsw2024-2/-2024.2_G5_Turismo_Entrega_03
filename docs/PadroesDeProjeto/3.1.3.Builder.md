# 3.1.3.Builder
## Introdução

Este artefato tem como objetivo documentar o conceito e a utilização do padrão gof Builder no projeto Eventour. O padrão criacional Gof é um conjunto de diferentes padrões para a criação de objetos. Com a utilização dos padrões de criação temos a criação de objetos de maneira dinâmica e desaclopada. O objetivo dos padrões de criação de objeto é desatrelar a lógica de utilização dos objetos da lógica de criação. O padrão builder que é um dos diferentes padrões de criação do conjunto Gof, permite e realiza a criação de objetos complexos separando a criação da representação final do objeto, reunindo em um método todos os métodos para construirem um objeto.

## Metodologia
Para implementarmos o padrão Builder em nosso projeto primeiro criamos um diagrama de classes no [Draw.io](), construindo a interface EventBuilder e as classes EventBuilde e EventDiretor, que irão importar das classes event seus atributos para serem instanciados  por meio da EventBuilder e retornar um objeto do timo event. Após isso implementamos o modelo construído no diagrama de classes dentro do sistema EvenTour. 

## Desenvolvimento

Abaixo na figura 01 temos o diagrama de classes descrevendo a utilização do padrão builder para a criação de objetos do tipo evento em nosso projeto. No diagrama temos a classe diretor que possui dois métodos o constructBasicEvent e o constructFullEvent, que respectivamente criam um evento com o essencial ou com todos os atributos possíveis. Temos a interface EventBuilderInterface que possui as assinaturas de todos os métodos para a criação de um evento, para a instanciação dos objetos temos a classe EventBuilder que importa a interface com os métodos já ditos. Por fim temos a classe Event que é a classe concreta base que contém os atributos de um evento e que é importada pela EventBuilder.

<font size="2"><p style="text-align: center">Figura 1 - Diagrama de classes EventBuilder.</p></font>

<center>

![imagem](../assets/Event_Builer.svg)

</center>

<font size="2"><p style="text-align: center">Autor(es): [Elias Oliveira][EliasGH] e [Claudio Henrique][ClaudioGH], 2024.</p></font>

Abaixo temos a implementação do padrão de criação builder implementando as classes utilizadas para a criação de objetos do tipo Event no nosso projeto utilizando a linguagem [NestJS](https://nestjs.com/), ou seja, já implementado na EventService e EventController.

#### EventBuilder
```js
import { Event } from './event.entity';

export class EventBuilder {
  private event: Event;

  constructor() {
    this.event = new Event();
  }

  setName(name: string): EventBuilder {
    this.event.name = name;
    return this;
  }

  setThemeId(theme: string): EventBuilder {
    this.event.theme = theme;
    return this;
  }

  setUserId(userId: string): EventBuilder {
    this.event.userId = =userId;
    return this;
  }

  setAdress(adress: string): EventBuilder {
    this.event.adress = adress;
    return this;
  }

  setLocation(Location: string): EventBuilder {
    this.event.Location = Location;
    return this;
  }

  setIndicativeAge(IndicativeAge: int): EventBuilder {
    this.event.IndicativeAge = IndicativeAge;
    return this;
  }

  setNumberFavorited(NumberFavorited: int): EventBuilder {
    this.event.NumberFavorited = NumberFavorited;
    return this;
  }

  setStartDate(Location: Date): EventBuilder {
    this.event.Location = Location;
    return this;
  }

  setEndDate(EndDate: Date): EventBuilder {
    this.event.EndDate = EndDate;
    return this;
  }

  setCreateAt(CreateAt: Date): EventBuilder {
    this.event.CreateAt = CreateAt;
    return this;
  }

  setTicketPrice(TicketPrice: float): EventBuilder {
    this.event.TicketPrice = TicketPrice;
    return this;
  }

  setDescription(Description: String): EventBuilder {
    this.event.Description = Description;
    return this;
  }

  setCommentList(CommentList: Comment): EventBuilder {
    this.event.CommentList = CommentList;
    return this;
  }

  getEvent(): Event {
    return event;
  }

  build(): Event {
    return this.event;
  }
}


```
#### EventService

```js
import { Injectable } from '@nestjs/common';
import { InjectRepository } from '@nestjs/typeorm';
import { Repository } from 'typeorm';
import { Event } from './event.entity';
import { EventBuilder } from './event-builder';
import { EventDirector } from './event-director';

@Injectable()
export class EventService {
  constructor(
    @InjectRepository(Event)
    private eventRepository: Repository<Event>,
  ) {}

  async createBasicEvent(eventDto: any): Promise<Event> {
    const builder = new EventBuilder();
    const director = new EventDirector(builder);

    const event = director.constructBasicEvent(
      eventDto.name,
      eventDto.themeId,
      eventDto.address,
      eventDto.startDate,
      eventDto.endDate,
      eventDto.description,
    );

    return await this.eventRepository.save(event);
  }

  async createFullEvent(eventDto: any): Promise<Event> {
    const builder = new EventBuilder();
    const director = new EventDirector(builder);

    const event = director.constructFullEvent(
      eventDto.name,
      eventDto.themeId,
      eventDto.userId,
      eventDto.address,
      eventDto.location,
      eventDto.indicativeAge,
      eventDto.numberFavorited,
      eventDto.startDate,
      eventDto.endDate,
      eventDto.createdAt,
      eventDto.ticketPrice,
      eventDto.description,
      eventDto.commentsList,
    );

    return await this.eventRepository.save(event);
  }
}

```

#### EventController

```js
import { Controller, Post, Body } from '@nestjs/common';
import { EventService } from './event.service';
import { Event } from './event.entity';

@Controller('events')
export class EventController {
  constructor(private readonly eventService: EventService) {}

  @Post('basic')
  async createBasicEvent(@Body() eventDto: any): Promise<Event> {
    return this.eventService.createBasicEvent(eventDto);
  }

  @Post('full')
  async createFullEvent(@Body() eventDto: any): Promise<Event> {
    return this.eventService.createFullEvent(eventDto);
  }
}

```

#### EventDiretor

```js
import { EventBuilder } from './event-builder';
import { Event } from './event.entity';

export class EventDirector {
  constructor(private readonly builder: EventBuilder) {}

  constructBasicEvent(
    name: string,
    themeId: string,
    address: string,
    startDate: Date,
    endDate: Date,
    description: string,
  ): Event {
    return this.builder
      .setName(name)
      .setThemeId(themeId)
      .setAddress(address)
      .setStartDate(startDate)
      .setEndDate(endDate)
      .setDescription({
        short: description,
        long: description,
      })
      .build();
  }

  constructFullEvent(
    name: string,
    themeId: string,
    userId: string,
    address: string,
    location: string,
    indicativeAge: number,
    numberFavorited: number,
    startDate: Date,
    endDate: Date,
    createdAt: Date,
    ticketPrice: number,
    description: { short: string; long: string },
    commentsList: any[],
  ): Event {
    return this.builder
      .setName(name)
      .setThemeId(themeId)
      .setUserId(userId)
      .setAddress(address)
      .setLocation(location)
      .setIndicativeAge(indicativeAge)
      .setNumberFavorited(numberFavorited)
      .setStartDate(startDate)
      .setEndDate(endDate)
      .setCreatedAt(createdAt)
      .setTicketPrice(ticketPrice)
      .setDescription(description)
      .setCommentsList(commentsList)
      .build();
  }
}


```



### Análise dos Resultados

A partir dos estudos conduzidos pela professora e dos materiais consultados vimos a importância e o quanto agrega ao projeto utilizar os padrões criacionais como o builder por exemplo, tornando o software mais organizado e menos oneroso criar objetos como evento e usuário.

<!-- ## Gravação da Reunião 

<font size="2"><p style="text-align: center">Vídeo 1 - Gravação da reunião X sobre Y </p></font>

<iframe width="560" height="315" 
  src="https://www.youtube.com/embed/codigo" 
  frameborder="0" 
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
  allowfullscreen>
</iframe>

<font size="2"><p style="text-align: center">Participantes: [Ciclano](CiclanoGH), [Fulano](FulanoGH) e [Beltrano](BeltranoGH), 11 de dez. de 2024.</p></font> -->

## Bibliografia

> 1. <a id="ref1"></a> Padrão criacional - Builder em: [Refactoring.guru](https://refactoring.guru/pt-br/design-patterns/builder). Acesso em: 09 de dez. de 2024.
> 2. <a id="ref2"></a>Design Patterns — Parte 6 — Builder. Disponível em: [Medium](https://medium.com/@jonesroberto/desing-patterns-parte-6-builder-f20752fb0c35). Acesso em: 09 de dez. de 2024.

## Histórico de Versões

| Versão | Data | Descrição | Autor(es) | Revisor(es) | Detalhes da revisão |
| :----: | :--: | --------- | ----------- | ------ | :---: |
| `1.0`  | 09/12/2024 | Criação do documento. | [Elias Oliveira][EliasGH] e [Claudio Henrique][ClaudioGH]  |  |  | 

[AnaGH]: https://github.com/analufernanndess
[CainaGH]: https://github.com/freitasc
[ClaudioGH]: https://github.com/claudiohsc
[EliasGH]: https://github.com/EliasOliver21
[GuilhermeGH]: https://github.com/gmeister18
[JoelGH]: https://github.com/JoelSRangel
[KathlynGH]: https://github.com/klmurussi
[PabloGH]: https://github.com/pabloheika
[PedroRGH]: https://github.com/pedro-rodiguero
[PedroPGH]: https://github.com/Pedrin0030
[SamuelGH]: https://github.com/samuelalvess
[TalesGH]: https://github.com/TalesRG
